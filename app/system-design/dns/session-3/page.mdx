## ЁЯЪА **Production-Level DNS**

ЁЯОп ржПржЗ рж╕рзЗрж╢ржирзЗ ржЖржкржирж┐ рж╢рж┐ржЦржмрзЗржитАФ

- DNS Load Balancing (RR, GeoDNS, Anycast)
- High Availability (Failover, Multi-Region)
- CDN ржХрзАржнрж╛ржмрзЗ DNS ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ
- TLS/SSL (https) basics
- HTTPS handshake (step-by-step)
- Real-world production architecture
- Implementation-based practice exercises
- Interview questions (20)

---

## тнР TOPIC 1: DNS Load Balancing (LB)

DNS Load Balancing рж╣рж▓рзЛ ржПржоржи ржПржХржЯрж┐ ржкржжрзНржзрждрж┐ ржпрзЗржЦрж╛ржирзЗ **ржПржХржЯрж┐ Domain тЖТ ржПржХрж╛ржзрж┐ржХ Server IP** рждрзЗ distribute ржХрж░рж╛ рж╣рзЯред
Server-ржЧрзБрж▓рзЛрж░ ржУржкрж░ Load рж╕ржорж╛ржиржнрж╛ржмрзЗ ржнрж╛ржЧ рж╣рзЯред

DNS рж▓рзЛржб ржмрзНржпрж╛рж▓рж╛ржирзНрж╕рж┐ржВрзЯрзЗрж░ рждрж┐ржиржЯрж┐ ржкрзНрз░ржзрж╛ржи ржкржжрзНржзрждрж┐:

- 1я╕ПтГг Round Robin
- 2я╕ПтГг GeoDNS (Geographical Load Balancing)
- 3я╕ПтГг Anycast DNS

---

#### 1я╕ПтГг ROUND ROBIN DNS (ржкрж╛рж▓рж╛ржХрзНрж░ржорзЗ ржмрж╛ рж╕рж┐рж░рж┐рзЯрж╛рж▓ ржЕржирзБржпрж╛рзЯрзА)
ржПржЯрж┐ рж╕ржмржЪрзЗрзЯрзЗ рж╕рж╛ржзрж╛рж░ржг ржПржмржВ ржХрж┐ржЫрзБржЯрж╛ "ржмрзЛржХрж╛" (Dumb) ржкржжрзНржзрждрж┐ред
* **ржХрж┐ржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ:** ржзрж░рзБржи ржЖржкржирж╛рж░ рзйржЯрж┐ рж╕рж╛рж░рзНржнрж╛рж░ ржЖржЫрзЗ (A, B, C)ред ржПржЯрж┐ ржЗржЙржЬрж╛рж░ржжрзЗрж░ ржПржХрзЗ ржПржХрзЗ ржнрж╛ржЧ ржХрж░рзЗ ржжрзЗрзЯ (User 1тЖТA, User 2тЖТB, User 3тЖТC)ред
* **рж╕ржорж╕рзНржпрж╛:** рж╕рж╛рж░рзНржнрж╛рж░ A ржирж╖рзНржЯ рж╣рзЯрзЗ ржЧрзЗрж▓рзЗржУ ржПржЯрж┐ ржЕржирзНржзрзЗрж░ ржорждрзЛ рж╕рзЗржЦрж╛ржирзЗ ржЗржЙржЬрж╛рж░ ржкрж╛ржарж╛рждрзЗ ржерж╛ржХрзЗред

### Example:

```
A   domain.com тЖТ 10.10.1.1  
A   domain.com тЖТ 10.10.1.2  
A   domain.com тЖТ 10.10.1.3  
```

**ржпржЦржи ржХрзЗржЙ domain ржЯрж╛ржЗржк ржХрж░рзЗ:**
DNS server response rotate ржХрж░рзЗ:

```
1st visitor тЖТ 10.10.1.1  
2nd visitor тЖТ 10.10.1.2  
3rd visitor тЖТ 10.10.1.3  
4th visitor тЖТ 10.10.1.1  
```

#### 2я╕ПтГг GEODNS (рж▓рзЛржХрзЗрж╢ржи ржмрж╛ ржПрж▓рж╛ржХрж╛ ржнрж┐рждрзНрждрж┐ржХ)
ржПржЯрж┐ ржПржХржЯрзБ рж╕рзНржорж╛рж░рзНржЯ, ржПржЯрж┐ ржЗржЙржЬрж╛рж░рзЗрж░ **ржкрж╛рж╕ржкрзЛрж░рзНржЯ (IP Address)** ржЪрзЗржХ ржХрж░рзЗред
* **ржХрж┐ржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ:** ржЗржЙржЬрж╛рж░ ржХрзЛржи ржжрзЗрж╢ ржерзЗржХрзЗ ржПрж╕рзЗржЫрзЗ рждрж╛ ржжрзЗржЦрзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ рж╕рж╛рж░рзНржнрж╛рж░рзЗ ржкрж╛ржарж╛рзЯред (ржЖржорзЗрж░рж┐ржХрж╛рж░ ржЗржЙржЬрж╛рж░ тЖТ ржЖржорзЗрж░рж┐ржХрж╛рж░ рж╕рж╛рж░рзНржнрж╛рж░ IP)ред
* **ржкрж╛рж░рзНржержХрзНржп:** ржПржЦрж╛ржирзЗ ржПржХрзЗржХ ржжрзЗрж╢рзЗрж░ ржЗржЙржЬрж╛рж░ **ржПржХрзЗржХ рж░ржХржо IP** ржкрж╛рзЯред
* **ржмрзНржпржмрж╣рж╛рж░:** Netflix ржмрж╛ Amazon Prime (ржпрзЗржЦрж╛ржирзЗ ржПржХ ржжрзЗрж╢рзЗрж░ ржХржирзНржЯрзЗржирзНржЯ ржЕржирзНржп ржжрзЗрж╢рзЗ ржжрзЗржЦрж╛ржирзЛ ржирж┐рж╖рзЗржз)ред

#### 3я╕ПтГг ANYCAST DNS (рж╕ржмржЪрзЗрзЯрзЗ ржХрж╛ржЫрзЗрж░ ржкрже ржмрж╛ ржорзНржпрж╛ржЬрж┐ржХ ржХрзНрж▓рзЛржи)

Anycast рж╣рж▓рзЛ ржПржоржи ржПржХржЯрж┐ рж╕рзНржорж╛рж░рзНржЯ ржЯрзЗржХржирзЛрж▓ржЬрж┐ ржпрзЗржЦрж╛ржирзЗ **"IP Address ржПржХржЯрж╛ржЗ, ржХрж┐ржирзНрждрзБ рж╕рж╛рж░рзНржнрж╛рж░ ржЕржирзЗржХржЧрзБрж▓рзЛ"**ред

#### ЁЯНФ рж╕рж╣ржЬ ржЙржжрж╛рж╣рж░ржг (ржорзНржпрж╛ржХржбрзЛржирж╛рж▓рзНржбрж╕ ржмрж╛ рзпрзпрзп)
ржнрж╛ржмрзБржи, **"McDonald's"** ржмрж╛ ржкрзБрж▓рж┐рж╢рзЗрж░ ржЗржорж╛рж░рзНржЬрзЗржирзНрж╕рж┐ ржиржорзНржмрж░ **"999"** рж╣рж▓рзЛ ржПржХржЯрж┐ IP Addressред
* ржЖржкржирж┐ ржпржжрж┐ **ржврж╛ржХрж╛рзЯ** ржжрж╛ржБрзЬрж┐рзЯрзЗ "McDonald's" ржЦрзЛржБржЬрзЗржи, ржЖржкржирж┐ ржЧрзБрж▓рж╢рж╛ржи ржмрж╛ ржмржирж╛ржирзАрж░ ржмрзНрж░рж╛ржЮрзНржЪрзЗ ржпрж╛ржмрзЗржиред
* ржЖржкржирж┐ ржпржжрж┐ **ржирж┐ржЙ ржЗрзЯрж░рзНржХрзЗ** ржерж╛ржХрзЗржи, ржЖржкржирж┐ рж╕рзЗржЦрж╛ржиржХрж╛рж░ рж▓рзЛржХрж╛рж▓ ржмрзНрж░рж╛ржЮрзНржЪрзЗ ржпрж╛ржмрзЗржиред

ржирж╛ржо ржХрж┐ржирзНрждрзБ ржПржХржЯрж╛ржЗтАФ**"McDonald's"**ред ржХрж┐ржирзНрждрзБ ржЖржкржирж┐ рж╕рж╛рж░рзНржнрж┐рж╕ ржкрж╛ржЪрзНржЫрзЗржи ржЖржкржирж╛рж░ **рж╕ржмржЪрзЗрзЯрзЗ ржХрж╛ржЫрзЗрж░** ржжрзЛржХрж╛ржиржЯрж┐ ржерзЗржХрзЗред **Anycast** ржарж┐ржХ ржПржнрж╛ржмрзЗржЗ ржХрж╛ржЬ ржХрж░рзЗред

#### тЪЩя╕П ржЯрзЗржХржирж┐ржХрзНржпрж╛рж▓ ржХрж╛ржЬ
рж╕рж╛ржзрж╛рж░ржгржд ржЖржорж░рж╛ ржЬрж╛ржирж┐, рззржЯрж┐ IP = рззржЯрж┐ рж╕рж╛рж░рзНржнрж╛рж░ред ржХрж┐ржирзНрждрзБ Anycast ржорзЗржержбрзЗ, **рззржЯрж┐ IP = ржкрзГржерж┐ржмрзАрж░ рж╢ржд рж╢ржд рж╕рж╛рж░рзНржнрж╛рж░**ред
ржпрзЗржоржи, Cloudflare-ржПрж░ `1.1.1.1` ржХрзЛржирзЛ ржПржХржЯрж┐ ржХржорзНржкрж┐ржЙржЯрж╛рж░рзЗрж░ ржарж┐ржХрж╛ржирж╛ ржирзЯред ржПржЯрж┐ рж╕рж╛рж░рж╛ ржмрж┐рж╢рзНржмрзЗ ржЫрзЬрж┐рзЯрзЗ ржерж╛ржХрж╛ рж╣рж╛ржЬрж╛рж░ рж╣рж╛ржЬрж╛рж░ рж╕рж╛рж░рзНржнрж╛рж░рзЗ ржХржиржлрж┐ржЧрж╛рж░ ржХрж░рж╛ ржЖржЫрзЗред рж░рзБржЯ рж╕рж╛рж░рзНржнрж╛рж░ржЧрзБрж▓рзЛржУ (Root Servers) ржПржЗ ржкржжрзНржзрждрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ, рждрж╛ржЗ ржорж╛рждрзНрж░ рззрзйржЯрж┐ ржЖржЗржкрж┐ ржжрж┐рзЯрзЗ ржмрж┐рж╢рзНржмржЬрзБрзЬрзЗ рззрзмрзжрзж+ рж╕рж╛рж░рзНржнрж╛рж░ ржЪрж▓рзЗред

#### тЬЕ рж╕рзБржмрж┐ржзрж╛
* **рж╕рзБржкрж╛рж░ ржлрж╛рж╕рзНржЯ:** ржирзЗржЯржУрзЯрж╛рж░рзНржХ ржЕржЯрзЛржорзЗржЯрж┐ржХ ржЖржкржирж╛ржХрзЗ рж╕ржмржЪрзЗрзЯрзЗ ржХрж╛ржЫрзЗрж░ рж╕рж╛рж░рзНржнрж╛рж░рзЗ ржХрж╛ржирзЗржХрзНржЯ ржХрж░рзЗ ржжрзЗрзЯред
* **High Availability:** ржХрзЛржирзЛ ржПржХржЯрж┐ рж╕рж╛рж░рзНржнрж╛рж░ ржирж╖рзНржЯ рж╣рзЯрзЗ ржЧрзЗрж▓рзЗ, ржЕржЯрзЛржорзЗржЯрж┐ржХ ржЕржирзНржп рж╕рж╛рж░рзНржнрж╛рж░ ржмрзНржпрж╛ржХржЖржк ржжрзЗрзЯред


#### ржнрзБрж▓ ржзрж╛рж░ржгрж╛ (Myth) vs ржмрж╛рж╕рзНрждржмрждрж╛ (Reality)

  * **ржнрзБрж▓ ржзрж╛рж░ржгрж╛:** Anycast ржорж╛ржирзЗ рж╣рж▓рзЛ ржкрзБрж░рзЛ `google.com` ржПрж░ ржЬржирзНржп ржкрзГржерж┐ржмрзАрждрзЗ ржорж╛рждрзНрж░ **рззржЯрж┐** IP ржерж╛ржХржмрзЗред
  * **ржмрж╛рж╕рзНрждржмрждрж╛:** Anycast ржорж╛ржирзЗ рж╣рж▓рзЛ **ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ IP** ржкрзГржерж┐ржмрзАрж░ ржЕржирзЗржХ ржЬрж╛рзЯржЧрж╛рзЯ ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗред ржХрж┐ржирзНрждрзБ рждрж╛рж░ ржорж╛ржирзЗ ржПржЗ ржирж╛ ржпрзЗ ржЧрзБржЧрж▓рзЗрж░ ржЖржЗржкрж┐ ржорж╛рждрзНрж░ ржПржХржЯрж╛ржЗ рж╣ржмрзЗред

ржЧрзБржЧрж▓ ржПржЦрж╛ржирзЗ **"Multiple Anycast IPs"** ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржЫрзЗред

### тЪб ржПржХржиржЬрж░рзЗ рждрзБрж▓ржирж╛ (Comparison Table)

| ржлрж┐ржЪрж╛рж░ | Round Robin (ржкрж╛рж▓рж╛ржХрзНрж░ржорзЗ) | GeoDNS (рж▓рзЛржХрзЗрж╢ржи ржнрж┐рждрзНрждрж┐ржХ) | Anycast (ржирж┐ржХржЯрждржо рж╕рж╛рж░рзНржнрж╛рж░) |
| :--- | :--- | :--- | :--- |
| **ржмрзБржжрзНржзрж┐ржорждрзНрждрж╛** | ржирзЗржЗ (ржмрзЛржХрж╛) | ржЖржЫрзЗ (рж▓рзЛржХрзЗрж╢ржи ржмрзЛржЭрзЗ) | ржЕржирзЗржХ ржмрзЗрж╢рж┐ (ржирзЗржЯржУрзЯрж╛рж░рзНржХ рж▓рзЗржнрзЗрж▓) |
| **IP Address** | ржнрж┐ржирзНржи ржнрж┐ржирзНржи IP ржжрзЗрзЯ | ржнрж┐ржирзНржи ржнрж┐ржирзНржи IP ржжрзЗрзЯ (ржжрзЗрж╢ржнрзЗржжрзЗ) | **рж╕ржмрж╛рж░ ржЬржирзНржп ржПржХржЗ IP** |
| **ржХрж╛ржЬ** | рж▓рзЛржб ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржХрж░рзЗ | ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржПрж▓рж╛ржХрж╛рж░ ржХржирзНржЯрзЗржирзНржЯ ржжрзЗржЦрж╛рзЯ | рж╕ржмржЪрзЗрзЯрзЗ ржлрж╛рж╕рзНржЯ рж░рзЗрж╕ржкржирзНрж╕ ржжрзЗрзЯ |
| **Failover** | рж╕рж╛рж░рзНржнрж╛рж░ ржбрж╛ржЙржи рж╣рж▓рзЗ ржмрзЛржЭрзЗ ржирж╛ | ржХржиржлрж┐ржЧрж╛рж░ ржХрж░рждрзЗ рж╣рзЯ | **ржЕржЯрзЛржорзЗржЯрж┐ржХ** (рж╕ржмржЪрзЗржпрж╝рзЗ ржирж┐рж░рж╛ржкржж) |
| **ржЙржжрж╛рж╣рж░ржг** | ржЫрзЛржЯ ржУрзЯрзЗржмрж╕рж╛ржЗржЯ | рж╕рзНржЯрзНрж░рж┐ржорж┐ржВ рж╕рж╛ржЗржЯ (Netflix) | Google DNS, Cloudflare, Root Servers |

**рж╕рж╣ржЬ рж╕рж╛рж░рж╛ржВрж╢:**
1.  **Round Robin:** рж▓рж╛ржЗржи ржзрж░рзЗ ржПржХржЬржи ржПржХржЬржи ржХрж░рзЗ ржкрж╛ржарж╛ржУред
2.  **GeoDNS:** ржкрж╛рж╕ржкрзЛрж░рзНржЯ ржЪрзЗржХ ржХрж░рзЛ, рждрж╛рж░ржкрж░ рж╕ржарж┐ржХ ржжрзЗрж╢рзЗ ржкрж╛ржарж╛ржУред
3.  **Anycast:** ржпрзЗ рж╕ржмржЪрзЗрзЯрзЗ ржХрж╛ржЫрзЗ ржЖржЫрзЛ, рж╕рзЗ рж╕рж╛рзЬрж╛ ржжрж╛ржУ (ржПржХржЗ ржирж╛ржорзЗрж░ ржЕржирзЗржХ ржХрзНрж▓рзЛржи)ред

---

## тнР TOPIC 2: High Availability (HA) with DNS

Production-ржП High Availability (HA) ржорж╛ржирзЗ service always up, even if:

* Server down
* Datacenter down
* Region down

HA DNS ржХрж░рж╛рж░ рждрж┐ржиржЯрж╛ ржЙржкрж╛рзЯ:

1я╕ПтГг Failover DNS
2я╕ПтГг Multi-region active-active
3я╕ПтГг CDN-based HA

---

рж╕рж╣ржЬ ржХржерж╛рзЯ: **HA ржорж╛ржирзЗ рж╣рж▓рзЛ, ржжрзБржирж┐рзЯрж╛ ржЙрж▓рзНржЯрзЗ ржЧрзЗрж▓рзЗржУ ржЖржкржирж╛рж░ ржУрзЯрзЗржмрж╕рж╛ржЗржЯ ржмржирзНржз рж╣ржмрзЗ ржирж╛ред**

ржирж┐ржЪрзЗ рждрж┐ржиржЯрж┐ ржкржжрзНржзрждрж┐рж░ рж╕рж╣ржЬ ржмрзНржпрж╛ржЦрзНржпрж╛ ржжрзЗржУрзЯрж╛ рж╣рж▓рзЛ:

---

### 1я╕ПтГг FAILOVER DNS (ржмрзНржпрж╛ржХржЖржк ржмрж╛ Spare Tire)

ржПржЯрж╛ржХрзЗ ржЧрж╛рзЬрж┐рж░ **Spare Tire**-ржПрж░ рж╕рж╛ржерзЗ рждрзБрж▓ржирж╛ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред

* **рж╕рж╛ржзрж╛рж░ржг ржЕржмрж╕рзНржерж╛:** ржЖржкржирж╛рж░ ржЧрж╛рзЬрж┐рждрзЗ рзкржЯрж┐ ржЪрж╛ржХрж╛ (Primary Server) ржЪрж▓ржЫрзЗред Spare Tire (Secondary Server) ржбрж┐ржХрж┐рждрзЗ ржЪрзБржкржЪрж╛ржк ржмрж╕рзЗ ржЖржЫрзЗред
* **ржмрж┐ржкржж рж╣рж▓рзЗ:** рж╣ржарж╛рзО рж░рж╛рж╕рзНрждрж╛рзЯ ржорзЗржЗржи ржЪрж╛ржХрж╛ ржкрж╛ржВржЪрж╛рж░ рж╣рзЯрзЗ ржЧрзЗрж▓ (Server Down)ред рждржЦржи ржЖржкржирж┐ Spare Tire рж▓рж╛ржЧрж╛рж▓рзЗржи ржПржмржВ ржЧрж╛рзЬрж┐ ржЖржмрж╛рж░ ржЪрж▓рждрзЗ рж╢рзБрж░рзБ ржХрж░рж▓ред
* **DNS-ржПрж░ ржХрж╛ржЬ:** DNS рж╕ржмрж╕ржорзЯ ржЪрзЗржХ ржХрж░рзЗ "ржорзЗржЗржи рж╕рж╛рж░рзНржнрж╛рж░ ржХрж┐ ржЬрзАржмрж┐ржд?" ржпржжрж┐ ржжрзЗржЦрзЗ ржорж░рзЗ ржЧрзЗржЫрзЗ, рж╕рзЗ рж╕рж╛ржерзЗ рж╕рж╛ржерзЗ ржЯрзНрж░рж╛ржлрж┐ржХ ржШрзБрж░рж┐рзЯрзЗ ржмрзНржпрж╛ржХржЖржк рж╕рж╛рж░рзНржнрж╛рж░рзЗ ржкрж╛ржарж┐рзЯрзЗ ржжрзЗрзЯред

> **Note:** ржПржЦрж╛ржирзЗ рж╕ржмрж╕ржорзЯ **ржПржХржЯрж┐** рж╕рж╛рж░рзНржнрж╛рж░ ржЪрж▓рзЗ, ржЕржирзНржпржЯрж┐ ржмрж┐ржкржжрзЗрж░ ржЬржирзНржп ржмрж╕рзЗ ржерж╛ржХрзЗред

---

### 2я╕ПтГг MULTI-REGION ACTIVE-ACTIVE (ржПржХрж╛ржзрж┐ржХ ржмрзНрж░рж╛ржЮрзНржЪ)

ржПржЯрж╛ржХрзЗ ржмрзНржпрж╛ржВржХрзЗрж░ ржмрж╛ рж╕рзБржкрж╛рж░рж╢ржкрзЗрж░ **ржПржХрж╛ржзрж┐ржХ ржмрзНрж░рж╛ржЮрзНржЪрзЗрж░** рж╕рж╛ржерзЗ рждрзБрж▓ржирж╛ ржХрж░рзБржиред

* **ржмрзНржпржмрж╕рзНржерж╛:** ржзрж░рзБржи ржврж╛ржХрж╛рзЯ ржЖржкржирж╛рж░ ржЕржлрж┐рж╕рзЗрж░ ржжрзБржЯрж┐ ржмрзНрж░рж╛ржЮрзНржЪ ржЖржЫрзЗтАФржПржХржЯрж┐ **ржЧрзБрж▓рж╢рж╛ржи**, ржЖрж░рзЗржХржЯрж┐ **ржзрж╛ржиржоржирзНржбрж┐**ред
* **рж╕рж╛ржзрж╛рж░ржг ржЕржмрж╕рзНржерж╛:** ржжрзБржЯрж┐ ржмрзНрж░рж╛ржЮрзНржЪржЗ рж╕ржмрж╕ржорзЯ ржЦрзЛрж▓рж╛ (Active)ред ржЧрзБрж▓рж╢рж╛ржирзЗрж░ ржорж╛ржирзБрж╖ ржЧрзБрж▓рж╢рж╛ржирзЗ ржпрж╛рзЯ, ржзрж╛ржиржоржирзНржбрж┐рж░ ржорж╛ржирзБрж╖ ржзрж╛ржиржоржирзНржбрж┐рждрзЗред
* **ржмрж┐ржкржж рж╣рж▓рзЗ:** рж╣ржарж╛рзО ржЧрзБрж▓рж╢рж╛ржи ржмрзНрж░рж╛ржЮрзНржЪрзЗ ржЖржЧрзБржи рж▓рж╛ржЧрж▓ (Region Down)ред рждржЦржи ржЧрзБрж▓рж╢рж╛ржирзЗрж░ ржХрж╛рж╕рзНржЯржорж╛рж░рж░рж╛ ржХрж┐ рж╕рзЗржмрж╛ ржкрж╛ржмрзЗ ржирж╛? ржЕржмрж╢рзНржпржЗ ржкрж╛ржмрзЗ, рждрж╛рж░рж╛ рждржЦржи ржзрж╛ржиржоржирзНржбрж┐ ржмрзНрж░рж╛ржЮрзНржЪрзЗ ржЧрж┐рзЯрзЗ ржХрж╛ржЬ ржХрж░ржмрзЗред
* **DNS-ржПрж░ ржХрж╛ржЬ:** ржЯрзНрж░рж╛ржлрж┐ржХ ржнрж╛ржЧ ржХрж░рзЗ ржжрзЗрзЯред ржПржХ ржЬрж╛рзЯржЧрж╛ ржмржирзНржз рж╣рж▓рзЗ, ржЕржирзНржп ржЬрж╛рзЯржЧрж╛ ржерзЗржХрзЗ рж╕рж╛рж░рзНржнрж┐рж╕ ржжрзЗрзЯред

> **Note:** ржПржЦрж╛ржирзЗ **рж╕ржмржЧрзБрж▓рзЛ** рж╕рж╛рж░рзНржнрж╛рж░ ржПржХрж╕рж╛ржерзЗ ржЪрж▓рзЗред



---

### 3я╕ПтГг CDN BASED HA (ржжрзЛржХрж╛ржирзЗрж░ рж╕рзНржЯржХ)

ржПржЯрж╛ржХрзЗ **ржлрзНржпрж╛ржХрзНржЯрж░рж┐ ржПржмржВ рж░рж┐ржЯрзЗржЗрж▓ ржжрзЛржХрж╛ржирзЗрж░** рж╕рж╛ржерзЗ рждрзБрж▓ржирж╛ ржХрж░рзБржиред

* **ржмрзНржпржмрж╕рзНржерж╛:** ржлрзНржпрж╛ржХрзНржЯрж░рж┐ (Origin Server) ржорж╛рж▓ ржмрж╛ржирж┐рзЯрзЗ ржжрзЛржХрж╛ржирзЗ (CDN) ржкрж╛ржарж╛рзЯред
* **ржмрж┐ржкржж рж╣рж▓рзЗ:** рж╣ржарж╛рзО ржлрзНржпрж╛ржХрзНржЯрж░рж┐рждрзЗ ржзрж░рзНржоржШржЯ рж╣рж▓рзЛ ржмрж╛ ржЙрзОржкрж╛ржжржи ржмржирзНржз рж╣рзЯрзЗ ржЧрзЗрж▓ (Server Down)ред
* **ржХрж╛рж╕рзНржЯржорж╛рж░ ржХрж┐ ржлрж┐рж░ржмрзЗ?** ржирж╛ред ржХрж╛рж░ржг ржжрзЛржХрж╛ржирзЗрж░ рждрж╛ржХрзЗ (Cache) ржЖржЧрзЗрж░ ржЕржирзЗржХ ржорж╛рж▓ ржЬржорж╛ржирзЛ ржЖржЫрзЗред ржлрзНржпрж╛ржХрзНржЯрж░рж┐ ржарж┐ржХ рж╣ржУрзЯрж╛рж░ ржЖржЧ ржкрж░рзНржпржирзНржд ржжрзЛржХрж╛ржиржжрж╛рж░ рж╕рзЗржЗ ржЬржорж╛ржирзЛ ржорж╛рж▓ (Cached Page) ржжрж┐рзЯрзЗ ржХрж╛рж╕рзНржЯржорж╛рж░ рж╕рж╛ржорж▓рж╛ржмрзЗред
* **Cloudflare-ржПрж░ ржХрж╛ржЬ:** ржЖржкржирж╛рж░ ржорзЗржЗржи рж╕рж╛рж░рзНржнрж╛рж░ ржХрзНрж░рзНржпрж╛рж╢ ржХрж░рж▓рзЗржУ, Cloudflare рждрж╛рж░ ржорзЗржорзЛрж░рж┐ ржерзЗржХрзЗ ржЖржкржирж╛рж░ рж╕рж╛ржЗржЯрзЗрж░ ржПржХржЯрж┐ ржХржкрж┐ ржЗржЙржЬрж╛рж░ржХрзЗ ржжрзЗржЦрж╛ржмрзЗред ржЗржЙржЬрж╛рж░ ржмрзБржЭрждрзЗржЗ ржкрж╛рж░ржмрзЗ ржирж╛ ржЖржкржирж╛рж░ рж╕рж╛рж░рзНржнрж╛рж░ ржмржирзНржзред



---

### тЪб ржПржХржиржЬрж░рзЗ ржкрж╛рж░рзНржержХрзНржп

| ржкржжрзНржзрждрж┐ | ржЙржжрж╛рж╣рж░ржг | ржХржЦржи ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯ? |
| :--- | :--- | :--- |
| **Failover** | ржЬрзЗржирж╛рж░рзЗржЯрж░ (ржХрж╛рж░рзЗржирзНржЯ ржЧрзЗрж▓рзЗ ржЪрж▓рзЗ) | ржЫрзЛржЯ ржмрж╛ ржорж╛ржЭрж╛рж░рж┐ рж╕рж╛ржЗржЯ, ржЦрж░ржЪ ржмрж╛ржБржЪрж╛рждрзЗред |
| **Active-Active** | ржмрзНржпрж╛ржВржХрзЗрж░ ржжрзБржЗ ржмрзНрж░рж╛ржЮрзНржЪ (ржжрзБржЯрзЛржЗ ржЦрзЛрж▓рж╛) | ржЧрзБржЧрж▓/ржлрзЗрж╕ржмрзБржХрзЗрж░ ржорждрзЛ ржЧрзНрж▓рзЛржмрж╛рж▓ рж╕рж╛ржЗржЯред |
| **CDN HA** | ржжрзЛржХрж╛ржирзЗрж░ ржЬржорж╛ржирзЛ ржорж╛рж▓ | ржирж┐ржЙржЬ рж╕рж╛ржЗржЯ ржмрж╛ ржмрзНрж▓ржЧ, ржпрзЗржЦрж╛ржирзЗ ржбрж╛ржЯрж╛ рж╕ржмрж╕ржорзЯ ржЪрзЗржЮрзНржЬ рж╣рзЯ ржирж╛ред |

### ЁЯФе Real-World Example: Netflix

Netflix uses:

* GeoDNS
* Anycast
* Multi-region HA
* CDN (Open Connect)

That's why Netflix never goes down.

---

## тнР TOPIC 3: How CDNs Use DNS

CDN ржХрзАржнрж╛ржмрзЗ DNS ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ, ржмрж┐рж╖рзЯржЯрж┐ ржЦрзБржмржЗ ржЗржирзНржЯрж╛рж░рзЗрж╕рзНржЯрж┐ржВред ржПржХрзЗ **"Pizza Delivery"** рж╕рж┐рж╕рзНржЯрзЗржорзЗрж░ рж╕рж╛ржерзЗ рждрзБрж▓ржирж╛ ржХрж░рж▓рзЗ ржмрзЛржЭрж╛ рж╕ржмржЪрзЗрзЯрзЗ рж╕рж╣ржЬ рж╣ржмрзЗред

### ЁЯНХ ржкрж┐ржЬрзНржЬрж╛ ржбрзЗрж▓рж┐ржнрж╛рж░рж┐ ржПржирж╛рж▓ржЬрж┐ (рж╕рж╣ржЬ ржЙржжрж╛рж╣рж░ржг)

ржоржирзЗ ржХрж░рзБржи `yourdomain.com` рж╣рж▓рзЛ **"Pizza Hut"**ред

* рзз. ржЖржкржирж┐ ржпржЦржи ржкрж┐ржЬрзНржЬрж╛ ржЕрж░рзНржбрж╛рж░ ржХрж░рзЗржи (ржУрзЯрзЗржмрж╕рж╛ржЗржЯрзЗ ржврзБржХрзЗржи), ржЖржкржирж┐ ржХрж┐ржирзНрждрзБ ржЖржорзЗрж░рж┐ржХрж╛рж░ рж╣рзЗржб ржЕржлрж┐рж╕рзЗ ржЕрж░рзНржбрж╛рж░ ржжрзЗржи ржирж╛ред
* рзи. ржЖржкржирж┐ ржПржХржЯрж┐ ржХржоржи ржирж╛ржорзНржмрж╛рж░рзЗ ржХрж▓ ржжрзЗржи (DNS Query)ред
* рзй. рж╕рзЗржЗ рж╕рж┐рж╕рзНржЯрзЗржо ржЪрзЗржХ ржХрж░рзЗ ржЖржкржирж╛рж░ ржмрж╛рж╕рж╛ ржХрзЛржерж╛рзЯ (User Location)ред
* рзк. ржПрж░ржкрж░ рж╕рзЗ ржЖржкржирж╛рж░ **рж╕ржмржЪрзЗрзЯрзЗ ржХрж╛ржЫрзЗрж░** ржмрж╛ржбрзНржбрж╛рж░ ржмрж╛ ржЧрзБрж▓рж╢рж╛ржирзЗрж░ ржмрзНрж░рж╛ржЮрзНржЪ ржерзЗржХрзЗ ржкрж┐ржЬрзНржЬрж╛ ржкрж╛ржарж╛рзЯ (Nearest PoP)ред

**CDN ржарж┐ржХ ржПржЗ ржХрж╛ржЬржЯрж┐ржЗ ржХрж░рзЗ DNS-ржПрж░ ржорж╛ржзрзНржпржорзЗред**

-----

### тЪЩя╕П ржЯрзЗржХржирж┐ржХрзНржпрж╛рж▓ ржкрзНрж░рж╕рзЗрж╕ (ржХрж┐ржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ?)

рж╕рж╛ржзрж╛рж░ржг DNS ржмрзЛржХрж╛ (Static IP ржжрзЗрзЯ), ржХрж┐ржирзНрждрзБ CDN-ржПрж░ DNS ржЕржирзЗржХ **ржЪрж╛рж▓рж╛ржХ (Smart)**ред

ржпржЦржи ржЖржкржирж┐ `yourdomain.com` ржП рж╣рж┐ржЯ ржХрж░рзЗржи:

* рзз. **ржбрж┐ржЯрзЗржХржЯрж┐ржн ржорзЛржб ржЕржи:** CDN-ржПрж░ DNS рж╕рж╛рж░рзНржнрж╛рж░ ржкрзНрж░ржержорзЗ ржЖржкржирж╛рж░ IP ржЕрзНржпрж╛ржбрзНрж░рзЗрж╕ ржЪрзЗржХ ржХрж░рзЗред
* рзи. **рж╣рж┐рж╕рж╛ржм-ржирж┐ржХрж╛рж╢:** рж╕рзЗ ржирж┐ржорзЗрж╖рзЗржЗ ржирж┐ржЪрзЗрж░ ржмрж┐рж╖рзЯржЧрзБрж▓рзЛ ржЪрзЗржХ ржХрж░рзЗ ржлрзЗрж▓рзЗтАФ
  * ржЖржкржирж┐ ржХрзЛржи ржжрзЗрж╢рзЗ ржЖржЫрзЗржи? (Location)
  * ржЖржкржирж╛рж░ ржЗржирзНржЯрж╛рж░ржирзЗржЯ рж╕рзНржкрж┐ржб ржХрзЗржоржи? (Latency)
  * ржЖржкржирж╛рж░ ржХрж╛ржЫрзЗрж░ рж╕рж╛рж░рзНржнрж╛рж░рзЗ ржХрж┐ ржнрж┐рзЬ ржЖржЫрзЗ? (Server Load)
  * ржХрзЛржи рж░рж╛рж╕рзНрждрж╛ ржжрж┐рзЯрзЗ ржЧрзЗрж▓рзЗ ржжрзНрж░рзБржд ржпрж╛ржУрзЯрж╛ ржпрж╛ржмрзЗ? (Route)
* рзй. **ржлрж╛ржЗржирж╛рж▓ рж╕рж┐ржжрзНржзрж╛ржирзНржд:** рж╕ржм рж╣рж┐рж╕рж╛ржм ржХрж░рзЗ рж╕рзЗ ржЖржкржирж╛ржХрзЗ ржЖржорзЗрж░рж┐ржХрж╛рж░ ржорзЗржЗржи рж╕рж╛рж░рзНржнрж╛рж░рзЗрж░ IP ржирж╛ ржжрж┐рзЯрзЗ, **ржврж╛ржХрж╛ ржмрж╛ рж╕рж┐ржЩрзНржЧрж╛ржкрзБрж░рзЗрж░** (ржЖржкржирж╛рж░ ржХрж╛ржЫрзЗрж░) рж╕рж╛рж░рзНржнрж╛рж░рзЗрж░ IP ржзрж░рж┐рзЯрзЗ ржжрзЗрзЯред

-----

### ЁЯЪА ржлрзНрж▓рзЛ ржбрж╛рзЯрж╛ржЧрзНрж░рж╛ржо (Real-World Flow)

```text
User (ржЖржкржирж┐ ржврж╛ржХрж╛рзЯ)
  тЖУ
DNS Query (рж╕рж╛ржЗржЯ ржХрзЛржерж╛рзЯ?)
  тЖУ
Cloudflare DNS (рж╕рзНржорж╛рж░рзНржЯ ржкрзБрж▓рж┐рж╢)
  тЖУ
Cloudflare ржжрзЗржЦрж▓: "ржЗржЙржЬрж╛рж░ ржмрж╛ржВрж▓рж╛ржжрзЗрж╢ ржерзЗржХрзЗ ржПрж╕рзЗржЫрзЗ"
  тЖУ
Cloudflare ржЪрзЗржХ ржХрж░рж▓: "ржЖржорж╛рж░ ржврж╛ржХрж╛рж░ рж╕рж╛рж░рзНржнрж╛рж░ ржХрж┐ ржлрзНрж░рж┐ ржЖржЫрзЗ?"
  тЖУ
Result: "рж╣рзНржпрж╛ржБ, ржлрзНрж░рж┐ ржЖржЫрзЗред"
  тЖУ
Response: ржврж╛ржХрж╛рж░ рж╕рж╛рж░рзНржнрж╛рж░рзЗрж░ IP ржжрж┐рж▓ (ржЖржорзЗрж░рж┐ржХрж╛рж░ ржирзЯ)
  тЖУ
Website Load (рж╕рзБржкрж╛рж░ ржлрж╛рж╕рзНржЯ, ржХрж╛рж░ржг рж╕рж╛рж░рзНржнрж╛рж░ ржЖржкржирж╛рж░ ржкрж╛рж╢рзЗржЗ)
```

**рж╕рж╛рж░ржорж░рзНржо:**
CDN ржорзВрж▓ржд DNS-ржХрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЖржкржирж╛ржХрзЗ **рж╢рж░рзНржЯржХрж╛ржЯ рж░рж╛рж╕рзНрждрж╛** ржжрзЗржЦрж┐рзЯрзЗ ржжрзЗрзЯред ржорзЗржЗржи рж╕рж╛рж░рзНржнрж╛рж░ ржжрзВрж░рзЗ ржерж╛ржХрж▓рзЗржУ, DNS-ржПрж░ ржмрзБржжрзНржзрж┐ржорж╛ржи рж░рж╛ржЙржЯрж┐ржВрзЯрзЗрж░ ржХрж╛рж░ржгрзЗ ржоржирзЗ рж╣рзЯ рж╕рж╛рж░рзНржнрж╛рж░ ржЖржкржирж╛рж░ ржкрж╛рж╢рзЗржЗ ржЖржЫрзЗред

<details>
<summary>ржЖржорж╛рж░ ржХржорзНржкрж┐ржЙржЯрж╛рж░ ржмрж╛ ржмрзНрж░рж╛ржЙржЬрж╛рж░ ржмрзБржЭрж▓рзЛ ржХрж┐ржнрж╛ржмрзЗ ржпрзЗ рждрж╛ржХрзЗ Cloudflare (1.1.1.1)-ржПрж░ ржХрж╛ржЫрзЗржЗ ржпрзЗрждрзЗ рж╣ржмрзЗ?</summary>

ржПржЯрж╛ ржЖрж╕рж▓рзЗ ржХрзЛржирзЛ ржорзНржпрж╛ржЬрж┐ржХ ржирзЯ, ржПржЯрж╛ рж╕ржорзНржкрзВрж░рзНржг **ржЖржкржирж╛рж░ ржмрж╛ ржЖржкржирж╛рж░ рж░рж╛ржЙржЯрж╛рж░рзЗрж░ "рж╕рзЗржЯрж┐ржВрж╕" (Configuration)**-ржПрж░ ржУржкрж░ ржирж┐рж░рзНржнрж░ ржХрж░рзЗред

---

### рзз. ржбрж┐ржлрж▓рзНржЯ ржЕржмрж╕рзНржерж╛ (ISP-ржПрж░ ржХрж╛ржЫрзЗ ржпрж╛ржУрзЯрж╛)
ржЖржкржирж┐ ржпржЦржи ржЗржирзНржЯрж╛рж░ржирзЗржЯ ржХрж╛ржирзЗржХрж╢ржи ржирзЗржи, рждржЦржи рж╕рж╛ржзрж╛рж░ржгржд **DHCP** (Dynamic Host Configuration Protocol) ржирж╛ржорзЗрж░ ржПржХржЯрж┐ рж╕рж┐рж╕рзНржЯрзЗржорзЗ рж╕ржмржХрж┐ржЫрзБ "Auto" ржХрж░рж╛ ржерж╛ржХрзЗред
* **ржЖржкржирж╛рж░ ржХржорзНржкрж┐ржЙржЯрж╛рж░:** "ржнрж╛ржЗ рж░рж╛ржЙржЯрж╛рж░, ржЖржорж┐ ржХрж╛рж░ ржХрж╛ржЫрзЗ DNS ржХрзБрзЯрзЗрж░рж┐ ржкрж╛ржарж╛ржмрзЛ?"
* **рж░рж╛ржЙржЯрж╛рж░ (ISP ржерзЗржХрзЗ ржкрж╛ржУрзЯрж╛):** "рждрзБржорж┐ ржЖржорж╛рж░ ржХрж╛ржЫрзЗржЗ ржкрж╛ржарж╛ржУ, ржЕржержмрж╛ ISP-ржПрж░ рж╕рж╛рж░рзНржнрж╛рж░рзЗ ржкрж╛ржарж╛ржУред"

рждрж╛ржЗ ржбрж┐ржлрж▓рзНржЯ ржЕржмрж╕рзНржерж╛рзЯ ржЖржкржирж╛рж░ ржХрзБрзЯрзЗрж░рж┐ Cloudflare-ржП ржпрж╛рзЯ ржирж╛, ISP-ржПрж░ ржХрж╛ржЫрзЗ ржпрж╛рзЯред

---

### рзи. Cloudflare-ржП ржпрж╛ржУрзЯрж╛рж░ ржирж┐рзЯржо (Manual Setup)
DNS ржХрзБрзЯрзЗрж░рж┐ Cloudflare-ржПрж░ ржХрж╛ржЫрзЗ рждржЦржиржЗ ржпрж╛ржмрзЗ, ржпржЦржи ржЖржкржирж┐ **"ржорзНржпрж╛ржирзБрзЯрж╛рж▓рж┐"** ржЖржкржирж╛рж░ ржХржорзНржкрж┐ржЙржЯрж╛рж░ ржмрж╛ рж░рж╛ржЙржЯрж╛рж░рзЗ ржмрж▓рзЗ ржжрзЗржмрзЗржиред

ржПржЯрж╛ ржжрзБржЗржнрж╛ржмрзЗ рж╣рждрзЗ ржкрж╛рж░рзЗ:

#### ржХ) ржЖржкржирж╛рж░ ржХржорзНржкрж┐ржЙржЯрж╛рж░рзЗ рж╕рзЗржЯ ржХрж░рж╛
ржЖржкржирж┐ ржпржЦржи ржЙржЗржирзНржбрзЛржЬ ржмрж╛ рж▓рж┐ржирж╛ржХрзНрж╕рзЗрж░ Network Settings-ржП ржЧрж┐рзЯрзЗ DNS ржЕржкрж╢ржирзЗ `1.1.1.1` ржмрж╕рж╛ржи, рждржЦржи ржЖржкржирж┐ ржорзВрж▓ржд ржЖржкржирж╛рж░ ржЕржкрж╛рж░рзЗржЯрж┐ржВ рж╕рж┐рж╕рзНржЯрзЗржоржХрзЗ (OS) ржПржХржЯрж┐ ржХрзЬрж╛ ржирж┐рж░рзНржжрзЗрж╢ ржжрж┐ржЪрзНржЫрзЗржи:
> *"рж╢рзЛржирзЛ OS, ржмрзНрж░рж╛ржЙржЬрж╛рж░ ржпржЦржиржЗ ржХрзЛржирзЛ ржУрзЯрзЗржмрж╕рж╛ржЗржЯрзЗрж░ ржЦрзЛржБржЬ ржХрж░ржмрзЗ, рждрзБржорж┐ ISP-ржХрзЗ ржЬрж┐ржЬрзНржЮрзЗрж╕ ржХрж░ржмрзЗ ржирж╛ред рж╕рзЛржЬрж╛ 1.1.1.1 (Cloudflare) ржПрж░ ржХрж╛ржЫрзЗ ржЪрж┐ржарж┐ ржкрж╛ржарж╛ржмрзЗред"*

#### ржЦ) ржЖржкржирж╛рж░ ржУрзЯрж╛ржЗржлрж╛ржЗ рж░рж╛ржЙржЯрж╛рж░рзЗ рж╕рзЗржЯ ржХрж░рж╛
ржЖржкржирж┐ ржпржжрж┐ рж░рж╛ржЙржЯрж╛рж░ ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржирзЗ `1.1.1.1` ржмрж╕рж┐рзЯрзЗ ржжрзЗржи, рждржмрзЗ ржУржЗ ржУрзЯрж╛ржЗржлрж╛ржЗ-ржП ржХрж╛ржирзЗржХрзНржЯ рж╣ржУрзЯрж╛ ржорзЛржмрж╛ржЗрж▓, рж▓рзНржпрж╛ржкржЯржк, ржЯрж┐ржнрж┐тАФрж╕ржмрж╛ржЗ ржЕржЯрзЛржорзЗржЯрж┐ржХ Cloudflare ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗред

---

### ЁЯЪА ржкрзНрж░рж╕рзЗрж╕ржЯрж┐ ржЖрж╕рж▓рзЗ ржпрзЗржнрж╛ржмрзЗ ржШржЯрзЗ (The Journey)

ржзрж░рзБржи ржЖржкржирж┐ рж╕рзЗржЯрж┐ржВрж╕рзЗ `1.1.1.1` рж╕рзЗржЯ ржХрж░рзЗржЫрзЗржиред ржПржЦржи ржлрзНрж▓рзЛ-ржЯрж╛ ржжрзЗржЦрзБржи:

* рзз. **Browser:** `google.com` ржПрж░ IP ржжрж░ржХрж╛рж░ред рж╕рзЗ OS-ржХрзЗ ржмрж▓рж▓ред
* рзи. **OS (ржЕржкрж╛рж░рзЗржЯрж┐ржВ рж╕рж┐рж╕рзНржЯрзЗржо):** рж╕рзЗ ржирж┐ржЬрзЗрж░ ржирзЗржЯржУрзЯрж╛рж░рзНржХ рж╕рзЗржЯрж┐ржВрж╕ ржбрж╛рзЯрзЗрж░рж┐ ржЪрзЗржХ ржХрж░рж▓ред ржжрзЗржЦрж▓ рж╕рзЗржЦрж╛ржирзЗ рж▓рзЗржЦрж╛ ржЖржЫрзЗ: `DNS Server: 1.1.1.1`ред
* рзй. **ржкрзНржпрж╛ржХрзЗржЯ рждрзИрж░рж┐:** OS ржПржХржЯрж┐ ржЦрж╛ржо (Data Packet) ржмрж╛ржирж╛рж▓ред ржЦрж╛ржорзЗрж░ ржУржкрж░рзЗ ржкрзНрж░рж╛ржкржХрзЗрж░ ржарж┐ржХрж╛ржирж╛ рж▓рж┐ржЦрж▓: `To: 1.1.1.1`ред
* рзк. **ISP-ржПрж░ ржнрзВржорж┐ржХрж╛ (ржбрж╛ржХржкрж┐ржпрж╝ржи):** ржПржЗ ржкрзНржпрж╛ржХрзЗржЯржЯрж┐ рждрж╛рж░ ржмрж╛ ржХрзЗржмрж▓ ржжрж┐рзЯрзЗ ржЖржкржирж╛рж░ ISP-ржПрж░ ржХрж╛ржЫрзЗ ржЧрзЗрж▓ред
* рзл. **ISP-ржПрж░ рж░рж╛ржЙржЯрж╛рж░:** ISP ржЦрж╛ржорзЗрж░ ржУржкрж░ ржжрзЗржЦрж▓ ржарж┐ржХрж╛ржирж╛ `1.1.1.1`ред ISP ржмрзБржЭрж▓ ржПржЯрж╛ рждрж╛рж░ ржирж┐ржЬрзЗрж░ ржЪрж┐ржарж┐ ржирж╛ред рж╕рзЗ рждржЦржи ржЗржирзНржЯрж╛рж░ржирзЗржЯрзЗрж░ рж░рж╛рж╕рзНрждрж╛ ржжрж┐рзЯрзЗ ржЪрж┐ржарж┐ржЯрж╛ Cloudflare-ржПрж░ ржжрж┐ржХрзЗ ржарзЗрж▓рзЗ ржжрж┐рж▓ред

---

### ЁЯУЭ рж╕рж╣ржЬ рж╕рж╛рж░рж╛ржВрж╢

ржкрзНрж░рж╢рзНржи: *"DNS ржерзЗржХрзЗ Cloudflare-ржП ржХрж┐ржнрж╛ржмрзЗ ржпрж╛рзЯ?"*

**ржЙрждрзНрждрж░:**
ржПржЯрж┐ ржЕржЯрзЛржорзЗржЯрж┐ржХ ржпрж╛рзЯ ржирж╛ред ржЖржкржирж╛рж░ ржХржорзНржкрж┐ржЙржЯрж╛рж░ ржПржХржЯрж┐ **"ржарж┐ржХрж╛ржирж╛рж░ ржмржЗ"** (Network Settings) ржорзЗржЗржиржЯрзЗржЗржи ржХрж░рзЗред
* ржпржжрж┐ рж╕рзЗржЦрж╛ржирзЗ ISP-ржПрж░ ржарж┐ржХрж╛ржирж╛ ржерж╛ржХрзЗ тЖТ ржХрзБрзЯрзЗрж░рж┐ ISP-ржПрж░ ржХрж╛ржЫрзЗ ржпрж╛рзЯред
* ржпржжрж┐ рж╕рзЗржЦрж╛ржирзЗ Cloudflare-ржПрж░ ржарж┐ржХрж╛ржирж╛ (`1.1.1.1`) рж▓рж┐ржЦрзЗ ржжрзЗржи тЖТ ржХрзБрзЯрзЗрж░рж┐ Cloudflare-ржПрж░ ржХрж╛ржЫрзЗ ржпрж╛рзЯред

ржЕрж░рзНржерж╛рзО, **"ржЧржирзНрждржмрзНржп"** ржЖржкржирж┐ ржЖржЧрзЗржЗ рж╕рзЗржЯрж┐ржВрж╕рзЗ ржарж┐ржХ ржХрж░рзЗ рж░рзЗржЦрзЗржЫрзЗржи ржмрж▓рзЗржЗ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯржЯрж┐ рж╕рзЗржЦрж╛ржирзЗ ржкрзМржБржЫрзЗржЫрзЗред
</details>

## тнР TOPIC 4: TLS/SSL Basics

HTTPS = HTTP + TLS security layer

TLS ensures:

ЁЯФТ Encryption
ЁЯФР Authentication
ЁЯЫб Integrity

Without TLS тЖТ data readable
With TLS тЖТ encrypted

---

## SSL/TLS KEY Concepts

* SSL Certificate (Public Key)
* Private Key
* Certificate Authority (CA)
* Root Certificate
* Intermediate Certificate

---

## тнР TOPIC 5: HTTPS Handshake (Step-by-Step)

When user opens `https://google.com`

---

## ЁЯФ╡ Step-by-step TLS Handshake

### 1я╕ПтГг Client Hello

Browser says:

* I want to connect
* My TLS version
* Supported cipher suites
* Random data

---

### 2я╕ПтГг Server Hello

Server sends:

* TLS version
* Chosen cipher suite
* SSL Certificate (public key)
* Its random data

---

### 3я╕ПтГг Certificate Verification

Browser checks:

* Certificate valid?
* Issued by trusted CA?
* Domain matches?

If OK тЖТ next step
If not тЖТ browser shows тАЬтЭЧNot SecureтАЭ

---

### 4я╕ПтГг Key Exchange

Browser creates a session key:

* Encrypts with serverтАЩs public key
* Sends to server
  Only server can decrypt (private key)

---

### 5я╕ПтГг Secure Tunnel Created

Both sides now use same symmetric key.

---

### 6я╕ПтГг Encrypted Communication Starts

Now all data travels encrypted.

---

## ЁЯФе Diagram: TLS Handshake

```
Client тЖТ Hello
Server тЖТ Hello + Certificate
Client тЖТ Verify + Key Exchange
Server тЖТ Confirm
Encrypted Communication Starts
```

---

## тнР TOPIC 6: Real-world Production Architecture (Example)

Here is a **real DevOps/SRE-grade infrastructure**:

```
                    +-------------------------+
User тЖТ Browser тЖТ DNS (Cloudflare / Route53)  |
                    +-------------------------+
                              тЖУ
                       (GeoDNS Routing)
                              тЖУ
        +--------------------+----------------------+
        |                    |                      |
   US Backend           EU Backend             Asia Backend
        |                    |                      |
     Auto-scaling       Auto-scaling            Auto-scaling
        |                    |                      |
          \                 |                      /
                    Database (Multi-region)
          /                 |                      \
        CDN (Anycast global caching network)
                              тЖУ
                           User
```

---

## тнР TOPIC 7: Practice Exercises (Implementation Based)

---

### **Exercise 1: Create Round Robin LB**

Set A records:

```
api.yourdomain.com тЖТ 10.10.1.1  
api.yourdomain.com тЖТ 10.10.1.2  
api.yourdomain.com тЖТ 10.10.1.3
```

Then test:

```
dig api.yourdomain.com
```

Does it rotate?

---

### **Exercise 2: Failover Setup**

Primary:

```
A тЖТ 10.10.1.1  
```

Backup:

```
A тЖТ 10.10.1.2
```

Set health check.

Test by shutting down primary.

---

### **Exercise 3: GeoDNS Testing**

Use Cloudflare Load Balancing
Set:

* Rule 1 тЖТ Users from Asia тЖТ Singapore
* Rule 2 тЖТ Users from Europe тЖТ Germany

Then test using VPN.

---

### **Exercise 4: TLS Handshake Monitoring**

Run:

```
openssl s_client -connect google.com:443
```

Identify:

* Certificate
* Cipher
* TLS version

---

### **Exercise 5: CDN Test**

Enable Cloudflare тЖТ Purge cache тЖТ Observe speed change.

---

## тнР INTERVIEW QUESTIONS (20)

1. DNS Load Balancing ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ?
2. Anycast ржХрзЗржи faster?
3. Round Robin ржПрж░ limitations ржХрзА?
4. GeoDNS ржХржЦржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржЙржЪрж┐ржд?
5. DNS Failover ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ?
6. Authoritative DNS ржПржмржВ Resolver ржПрж░ ржкрж╛рж░рзНржержХрзНржп?
7. CDN ржХрзАржнрж╛ржмрзЗ DNS ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ?
8. SSL/TLS ржХрзА?
9. HTTPS handshake step-by-step ржмрзНржпрж╛ржЦрзНржпрж╛ ржХрж░рзЛред
10. Difference between SSL certificate & private key?
11. DNSSEC vs TLS?
12. What is CNAME flattening?
13. Cloudflare ржХрзАржнрж╛ржмрзЗ Anycast use ржХрж░рзЗ?
14. TTL ржХржо ржжрж┐рж▓рзЗ рж╕ржорж╕рзНржпрж╛ ржХрзА?
15. Multi-region HA ржХрзАржнрж╛ржмрзЗ achieve ржХрж░ржмрзЗ?
16. CDN PoP ржХрзА?
17. OCSP Stapling ржХрзА?
18. HSTS ржХрзА?
19. DNS latency ржХржорж╛ржирзЛрж░ ржЙржкрж╛рзЯ?
20. Why is Anycast better for DDoS protection?

---

## тнР SESSION 3 SUMMARY (Cheat Sheet)

```
LB Types:
- Round Robin
- GeoDNS
- Anycast

HA:
- Failover
- Multi-region
- CDN-based

TLS:
- Public/Private Key
- Certificate
- CA
- Handshake steps

CDN:
- PoP
- Cache
- Anycast routing
```

---