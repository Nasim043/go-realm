### ЁЯза **Day 1: Go Concurrency Foundations & Goroutines**

ржПржЗ ржкрзНрж░ржержо ржжрж┐ржирзЗ рждрзБржорж┐ рж╢рж┐ржЦржмрзЗ GoLang ржХржиржХрж╛рж░рзЗржирзНрж╕рж┐рж░ (Concurrency) ржЖрж╕рж▓ рж╢ржХрзНрждрж┐ тАФ **Goroutine**ред
ржЖржорж░рж╛ ржзрж╛ржкрзЗ ржзрж╛ржкрзЗ рж╢рж┐ржЦржм ржХрзАржнрж╛ржмрзЗ GoLang ржПржХрж╕рж╛ржерзЗ ржЕржирзЗржХ ржХрж╛ржЬ ржкрж░рж┐ржЪрж╛рж▓ржирж╛ ржХрж░рзЗ, ржХрзАржнрж╛ржмрзЗ Goroutine ржХрж╛ржЬ ржХрж░рзЗ, ржЖрж░ ржХрзЗржи ржПржЧрзБрж▓рзЛ ржПржд ржжрзНрж░рзБржд ржУ рж▓рж╛ржЗржЯржУржпрж╝рзЗржЯред


---

## ЁЯОп **ржЖржЬржХрзЗрж░ рж▓ржХрзНрж╖рзНржп**

1. **Concurrency** ржУ **Parallelism** ржПрж░ ржоржзрзНржпрзЗ ржкрж╛рж░рзНржержХрзНржп ржкрзБрж░рзЛржкрзБрж░рж┐ ржмрзЛржЭрж╛
2. **Goroutine** ржПрж░ ржнрж┐рждрж░рзЗрж░ ржорзЗржХрж╛ржирж┐ржЬржо рж╢рзЗржЦрж╛
3. **Go Scheduler (M-P-G Model)** ржПрж░ ржХрж╛ржЬ ржмрзЛржЭрж╛
4. ржХрзЗржи Goroutine тАЬLightweight ThreadтАЭ ржмрж▓рж╛ рж╣рзЯ
5. **Stack Management, Preemption, Scheduling Cycle** ржмрзЛржЭрж╛
6. ржХрзЗржи main ржлрж╛ржВрж╢ржи рж╢рзЗрж╖ рж╣рж▓рзЗ Goroutine ржЧрзБрж▓рзЛржУ ржмржирзНржз рж╣рзЯрзЗ ржпрж╛рзЯ тАФ рж╕рзЗржЯрж╛ ржжрзЗржЦрж╛ред
7. **Runtime Behavior, Memory Cost, Performance Insight** ржмрзЛржЭрж╛

---

## ЁЯзй **рзз. Concurrency vs Parallelism тАФ ржорзВрж▓ ржнрж┐рждрзНрждрж┐**

| ржзрж╛рж░ржгрж╛       | Concurrency                                                        | Parallelism                                   |
| ----------- | ------------------------------------------------------------------ | --------------------------------------------- |
| ржЕрж░рзНрже        | ржПржХрж╕рж╛ржерзЗ ржЕржирзЗржХ ржХрж╛ржЬ *ржкрж░рж┐ржЪрж╛рж▓ржирж╛ ржХрж░рж╛*                                     | ржПржХрж╕рж╛ржерзЗ ржЕржирзЗржХ ржХрж╛ржЬ *ржЪрж╛рж▓рж╛ржирзЛ*                      |
| ржХрзЛрж░ ржмрзНржпржмрж╣рж╛рж░ | ржПржХ ржХрзЛрж░рзЗржУ рж╕ржорзНржнржм                                                     | ржПржХрж╛ржзрж┐ржХ ржХрзЛрж░ рж▓рж╛ржЧрзЗ                               |
| ржЙржжрзНржжрзЗрж╢рзНржп    | ржХрзЛржбржХрзЗ responsive рж░рж╛ржЦрж╛                                              | ржкрж╛рж░ржлрж░ржорзНржпрж╛ржирзНрж╕ ржмрж╛рзЬрж╛ржирзЛ                           |
| ржЙржжрж╛рж╣рж░ржг      | ржПржХржЬржи рж░рж╛ржБржзрзБржирж┐ рзйржЯрж╛ ржкржж ржПржХрж╕рж╛ржерзЗ рждрзИрж░рж┐ ржХрж░ржЫрзЗ, ржПржХржЯрж╛рж░ ржХрж╛ржЬ ржХрж░рзЗ ржЖрж░рзЗржХржЯрж╛рзЯ ржпрж╛ржЪрзНржЫрзЗ | рзйржЬржи рж░рж╛ржБржзрзБржирж┐ рзйржЯрж╛ ржкржж ржПржХрж╕рж╛ржерзЗ рждрзИрж░рж┐ ржХрж░ржЫрзЗ           |
| Go рждрзЗ       | goroutine switching                                                | goroutine ржЧрзБрж▓рзЛ ржЖрж▓рж╛ржжрж╛ CPU core ржП parallel ржЪрж▓ржЫрзЗ |

ЁЯФ╣ **Concurrency = Structure of doing multiple tasks**
ЁЯФ╣ **Parallelism = Execution of those tasks together**

Go Concurrent design follow ржХрж░рзЗ тЖТ рждрж╛ржЗ multi-core ржП parallel run ржХрж░рждрзЗ ржУ рж╕ржХрзНрж╖ржоред

Go ржорзВрж▓ржд **Concurrent-first language**, ржорж╛ржирзЗ ржПржЯрж┐ ржПржоржиржнрж╛ржмрзЗ ржбрж┐ржЬрж╛ржЗржи ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ ржпрж╛рждрзЗ рждрзБржорж┐ ржХрж╛ржЬржЧрзБрж▓рзЛржХрзЗ рж╕рзБржирзНржжрж░ржнрж╛ржмрзЗ ржнрж╛ржЧ ржХрж░рждрзЗ ржкрж╛рж░рзЛ, ржкрж░рзЗ runtime ржЪрж╛ржЗрж▓рзЗ ржПржХрзЗ parallel ржХрж░рждрзЗ ржкрж╛рж░рзЗред

---

## ЁЯзй **рзи. Goroutine тАФ Go рж░ Concurrency ржПрж░ рж╣рзГржжржкрж┐ржгрзНржб**

**Goroutine** рж╣рж▓рзЛ Go-ржПрж░ concurrency-ржПрж░ рж╕ржмржЪрзЗрзЯрзЗ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржЗржЙржирж┐ржЯред
ржПржЯрж┐ рж╣рж▓рзЛ ржПржХржзрж░ржирзЗрж░ тАЬрж▓рж╛ржЗржЯржУрзЯрзЗржЯ ржерзНрж░рзЗржбтАЭ ржпрж╛ Go runtime ржирж┐ржЬрзЗ рждрзИрж░рж┐, ржорзНржпрж╛ржирзЗржЬ, ржПржмржВ schedule ржХрж░рзЗред

рждрзБржорж┐ ржпрзЗржнрж╛ржмрзЗ ржирждрзБржи Goroutine рж╢рзБрж░рзБ ржХрж░рждрзЗ ржкрж╛рж░рзЛ:

```go
go myFunction()
```

ржПрждрзЗ runtime ржПржХржЯрж┐ ржирждрзБржи goroutine рждрзИрж░рж┐ ржХрж░рзЗ, ржпрж╛рж░ ржирж┐ржЬрж╕рзНржм:

* ржЫрзЛржЯ stack (~2 KB ржерзЗржХрзЗ рж╢рзБрж░рзБ)
* scheduling data (ржХрзЛржерж╛рзЯ ржЪрж▓ржЫрзЗ, ready/blocked ржЗрждрзНржпрж╛ржжрж┐)
* heap shared with others (рж╕ржм goroutine ржПржХржЗ heap use ржХрж░рзЗ)

### ЁЯза ржоржирзЗ рж░рж╛ржЦрзЛ:

* Go рждрзЗ **рж╕ржмржХрж┐ржЫрзБ Goroutine** тАФ main() ржирж┐ржЬрзЗржУ ржПржХржЯрж┐ goroutineред
* Go runtime goroutine ржжрзЗрж░ OS thread ржПрж░ ржЙржкрж░ ржорзНржпрж╛ржирзЗржЬ ржХрж░рзЗред

---


ржПржХржжржо ржарж┐ржХ ржмрж▓рзЗржЫрзЛ ЁЯСН тАФ M-P-G model ржкрзНрж░ржержорзЗ ржПржХржЯрзБ ржЬржЯрж┐рж▓ ржоржирзЗ рж╣рзЯ, ржХрж┐ржирзНрждрзБ рж╕рж╣ржЬ ржЙржжрж╛рж╣рж░ржг ржЖрж░ рждрзБрж▓ржирж╛ ржжрж┐рж▓рзЗ ржмрж┐рж╖рзЯржЯрж╛ ржПржХржжржо ржкрж░рж┐рж╖рзНржХрж╛рж░ рж╣рзЯрзЗ ржпрж╛рзЯред ржирж┐ржЪрзЗ ржЖржорж┐ рждрзЛржорж╛рж░ ржЕржВрж╢ржЯрж╛ **ржЦрзБржм рж╕рж╣ржЬ ржнрж╛рж╖рж╛рзЯ**, **ржЙржжрж╛рж╣рж░ржгрж╕рж╣** рж▓рж┐ржЦрзЗ ржжрж┐рж▓рж╛ржо ЁЯСЗ

---

## ЁЯзй **рзйя╕П. Go Runtime Scheduler (MтАУPтАУG Model рж╕рж╣ржЬржнрж╛ржмрзЗ)**

* Go ржПрж░ ржоржзрзНржпрзЗ ржПржХржЯрж┐ ржирж┐ржЬрж╕рзНржм тАЬmini managerтАЭ ржЖржЫрзЗ, ржпрж╛ржХрзЗ ржмрж▓рзЗ **Scheduler**ред
* ржПржЗ scheduler ржарж┐ржХ ржХрж░рзЗ ржХрзЛржи **goroutine** ржХржЦржи, ржХрзЛржи **CPU core** ржП ржЪрж▓ржмрзЗред

### тЪЩя╕П **рждрж┐ржиржЯрж┐ ржЕржВрж╢**

| ржирж╛ржо   | ржкрзБрж░рзЛ ржЕрж░рзНрже | ржХрж╛ржЬ                                                  |
| ----- | --------- | ---------------------------------------------------- |
| **G** | Goroutine | ржЖржорж╛ржжрзЗрж░ ржХрзЛржб ржмрж╛ ржХрж╛ржЬ (ржпрж╛ run рж╣ржмрзЗ)                       |
| **M** | Machine   | ржЖрж╕рж▓ OS thread (ржпрзЗржЯрж╛ CPU рждрзЗ ржЪрж▓рзЗ)                      |
| **P** | Processor | Goroutine ржЧрзБрж▓рзЛржХрзЗ рж╕рж╛ржЬрж┐рзЯрзЗ рж░рж╛ржЦрзЗ ржПржмржВ M ржПрж░ рж╕рж╛ржерзЗ ржпрзБржХрзНржд ржХрж░рзЗ |

---

### ЁЯОм **рж╕рж╣ржЬ ржЙржжрж╛рж╣рж░ржг**

ржзрж░рзЛ рждрзБржорж┐ ржПржХржЬржи рж░рзЗрж╕рзНржЯрзБрж░рзЗржирзНржЯ ржорзНржпрж╛ржирзЗржЬрж╛рж░:

* ЁЯН╜я╕П **Goroutine (G)** = ржЕржирзЗржХржЧрзБрж▓рзЛ ржЕрж░рзНржбрж╛рж░ (ржкрзНрж░рждрж┐ржЯрж┐ рж░рж╛ржирзНржирж╛ ржЖрж▓рж╛ржжрж╛ ржХрж╛ржЬ)
* ЁЯСитАНЁЯН│ **Processor (P)** = ржПржХржЬржи рж╢рзЗржлрзЗрж░ рж╕рж╣ржХрж╛рж░рзА, ржпрж┐ржирж┐ ржЕрж░рзНржбрж╛рж░ рж╕рж╛ржЬрж┐рзЯрзЗ ржжрзЗржи
* ЁЯФз **Machine (M)** = ржЖрж╕рж▓ рж╢рзЗржл, ржпрж┐ржирж┐ рж░рж╛ржирзНржирж╛ ржХрж░рзЗржи (CPU thread)

рждрзБржорж┐ (Scheduler) ржжрзЗржЦржЫрзЛ ржпрзЗржи рж╢рзЗржл (M) ржЕрж▓рж╕ ржирж╛ ржерж╛ржХрзЗ тАФ
рждрж╛ржЗ рждрзБржорж┐ P ржПрж░ queue ржерзЗржХрзЗ ржЕрж░рзНржбрж╛рж░ (G) ржирж┐рзЯрзЗ рждрж╛ржХрзЗ ржжрж┐ржЪрзНржЫрзЛред

ржпржжрж┐ ржПржХ рж╢рзЗржлрзЗрж░ рж╕ржм ржЕрж░рзНржбрж╛рж░ рж╢рзЗрж╖ рж╣рзЯрзЗ ржпрж╛рзЯ, рж╕рзЗ ржЕржирзНржп рж╢рзЗржлрзЗрж░ рж╕рж╣ржХрж╛рж░рзАрж░ ржХрж╛ржЫ ржерзЗржХрзЗ ржЕрж░рзНржбрж╛рж░ тАЬржЪрзБрж░рж┐тАЭ ржХрж░рждрзЗ ржкрж╛рж░рзЗ (ржПржЯрж╛ржЗ **work stealing**) ЁЯШД

---

### ЁЯФД **ржХрж╛ржЬрзЗрж░ ржзрж╛ржк**

1. ржкрзНрж░рждрж┐ржЯрж┐ **P** ржПрж░ ржПржХржЯрж┐ ржЫрзЛржЯ queue ржерж╛ржХрзЗ ржпрзЗржЦрж╛ржирзЗ goroutine ржЧрзБрж▓рзЛ ржЕржкрзЗржХрзНрж╖рж╛ ржХрж░рзЗред
2. ржХрзЛржирзЛ **M (thread)** ржлрж╛ржБржХрж╛ ржерж╛ржХрж▓рзЗ, **P** рждрж╛ржХрзЗ ржХрж╛ржЬ ржжрзЗрзЯред
3. **GOMAXPROCS** ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рзЗ ржХрзЯржЯрж╛ P (logical core) ржмрзНржпржмрж╣рж╛рж░ рж╣ржмрзЗред
4. ржпржжрж┐ ржХрзЛржирзЛ goroutine ржмрзНрж▓ржХ рж╣рзЯ (ржпрзЗржоржи I/O), scheduler рж╕рж╛ржерзЗ рж╕рж╛ржерзЗ ржЕржирзНржпржЯрж╛ ржЪрж╛рж▓рж╛рзЯред

---

### тЪЩя╕П **M:N Scheduling ржорж╛ржирзЗ ржХрзА**

Go runtime ржЕржирзЗржХржЧрзБрж▓рзЛ (**N**) goroutine ржХрзЗ
ржХржо рж╕ржВржЦрзНржпржХ (**M**) OS thread-ржПрж░ ржЙржкрж░ ржЪрж╛рж▓рж╛рзЯред

> ЁЯза ржорж╛ржирзЗ тАФ рж╣рж╛ржЬрж╛рж░ рж╣рж╛ржЬрж╛рж░ goroutine ржЪрж▓ржмрзЗ,
> ржХрж┐ржирзНрждрзБ CPU thread рж▓рж╛ржЧржмрзЗ ржЦрзБржм ржХржо!

---

### ЁЯМА **Work Stealing (рж╕рж╣ржЬржнрж╛ржмрзЗ)**

ржпржжрж┐ ржХрзЛржирзЛ processor-ржПрж░ queue ржлрж╛ржБржХрж╛ ржерж╛ржХрзЗ,
рж╕рзЗ ржЕржирзНржп processor-ржПрж░ queue ржерзЗржХрзЗ goroutine ржирж┐рзЯрзЗ ржирзЗрзЯред

ЁЯСЙ ржПрждрзЗ CPU ржХржЦржирзЛ ржлрж╛ржБржХрж╛ ржмрж╕рзЗ ржерж╛ржХрзЗ ржирж╛, рж╕ржмрж╕ржорзЯ ржмрзНржпрж╕рзНржд ржерж╛ржХрзЗред

---

### тЬЕ **рж╕ржВржХрзНрж╖рж┐ржкрзНржд рж╕рж╛рж░рж╛ржВрж╢**

| ржкрзЯрзЗржирзНржЯ        | рж╕рж╣ржЬ ржмрзНржпрж╛ржЦрзНржпрж╛                           |
| ------------- | -------------------------------------- |
| Goroutine (G) | ржХрж╛ржЬ ржХрж░рж╛рж░ ржЗржЙржирж┐ржЯ                         |
| Processor (P) | ржХрж╛ржЬ рж╕рж╛ржЬрж╛рзЯ ржПржмржВ thread-ржПрж░ рж╕рж╛ржерзЗ bind ржХрж░рзЗ  |
| Machine (M)   | CPU-рждрзЗ ржЪрж▓рж╛ ржЖрж╕рж▓ thread                  |
| Scheduler     | рж╕ржм ржХрж┐ржЫрзБ manage ржХрж░рзЗ                     |
| GOMAXPROCS    | ржХрзЯржЯрж╛ CPU core ржмрзНржпржмрж╣рж╛рж░ рж╣ржмрзЗ ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рзЗ |
| Work Stealing | idle CPU ржЕржирзНржпржжрзЗрж░ ржХрж╛ржЬ ржирж┐рзЯрзЗ ржирзЗрзЯ          |

---

### ЁЯзй **ржЪрзЛржЦрзЗ ржжрзЗржЦрж╛ ржЫрзЛржЯ ржбрж╛ржпрж╝рж╛ржЧрзНрж░рж╛ржо**

```
G1, G2, G3  тЖТ  [P1]  тЖТ  [M1]
G4, G5, G6  тЖТ  [P2]  тЖТ  [M2]
```

ржпржжрж┐ P1 ржПрж░ queue ржлрж╛ржБржХрж╛ рж╣рзЯ, рж╕рзЗ P2 ржерзЗржХрзЗ G ржЪрзБрж░рж┐ ржХрж░рждрзЗ ржкрж╛рж░рзЗ ЁЯМА

---

## ЁЯзй **рзк. Lightweight Thread ржорж╛ржирзЗ ржХрзА?**
Goroutine-ржХрзЗ ржмрж▓рж╛ рж╣рзЯ **тАЬLightweight ThreadтАЭ**, ржХрж╛рж░ржг ржПржЯрж┐ рж╕рж╛ржзрж╛рж░ржг OS thread-ржПрж░ рждрзБрж▓ржирж╛рзЯ ржЕржирзЗржХ **рж╣рж╛рж▓ржХрж╛, ржжрзНрж░рзБржд, ржПржмржВ ржХржо ржорзЗржорж░рж┐-ржмрзНржпрзЯрзА**ред
Go runtime ржирж┐ржЬрзЗржЗ ржПржЧрзБрж▓рзЛ рждрзИрж░рж┐ ржУ ржирж┐рзЯржирзНрждрзНрж░ржг ржХрж░рзЗ, рждрж╛ржЗ OS kernel-ржХрзЗ ржШржиржШржи ржбрж╛ржХрж╛рж░ ржжрж░ржХрж╛рж░ рж╣рзЯ ржирж╛ред

| ржмрж┐рж╖рзЯ           | OS Thread      | Goroutine              |
| -------------- | -------------- | ---------------------- |
| Stack Size     | ~1MB ржерзЗржХрзЗ 2MB (fixed) |ржорж╛рждрзНрж░ ~2KB ржерзЗржХрзЗ рж╢рзБрж░рзБ рж╣рзЯ ржПржмржВ ржкрзНрж░рзЯрзЛржЬржи ржЕржирзБржпрж╛рзЯрзА ржмрж╛рзЬрзЗ ржмрж╛ ржХржорзЗ (dynamic growth) |
| Managed By     | OS kernel      | Go runtime (user-space)             |
| Context Switch | Slow (Kernel-level)    | Fast (User-space)                   |
| Creation Time  | Slow (ржЕржирзЗржХ ржмрзЗрж╢рж┐)         | Fast (microseconds level)  (ржЕржирзЗржХ ржХржо рж╕ржоржпрж╝)       |
| Typical Count  | рж╕рж╛ржзрж╛рж░ржгржд ржХрзЯрзЗржХ рж╣рж╛ржЬрж╛рж░ ржкрж░рзНржпржирзНржд рж╕ржорзНржнржм    | рж▓ржХрзНрж╖рж╛ржзрж┐ржХ goroutine ржПржХрж╕рж╛ржерзЗ ржЪрж▓рждрзЗ ржкрж╛рж░рзЗ        |


### ЁЯТб **ржХрзЗржи Lightweight ржмрж▓рж╛ рж╣рзЯ?**

Goroutine рж╣рж╛рж▓ржХрж╛ рж╣ржУрзЯрж╛рж░ ржкрзНрж░ржзрж╛ржи ржХрж╛рж░ржгржЧрзБрж▓рзЛ:

* Dynamic Stack
* Context switch kernel-level ржирзЯ тЖТ рждрж╛ржЗ ржЕржирзЗржХ ржжрзНрж░рзБржд
* Long-running goroutine ржХрзЗ runtime ржЬрзЛрж░ ржХрж░рзЗ ржерж╛ржорж┐рзЯрзЗ ржЕржирзНржп goroutine ржХрзЗ ржЪрж╛рж▓рж╛рждрзЗ ржкрж╛рж░рзЗ
* ржлрж▓рзЗ starvation ржмрж╛ hang рж╣рзЯ ржирж╛
---

## ЁЯзй **рзля╕П. Stack Growth Mechanism**

* ржкрзНрж░рждрж┐ржЯрж┐ Goroutine ржкрзНрж░рж╛рзЯ **рзиKB stack** ржжрж┐рзЯрзЗ рж╢рзБрж░рзБ рж╣рзЯред
* ржпржЦржи function call depth ржмрж╛рзЬрзЗ тЖТ Go runtime рж╕рзНржмрзЯржВржХрзНрж░рж┐рзЯржнрж╛ржмрзЗ stack ржмрзЬ ржХрж░рзЗ ржлрзЗрж▓рзЗ
* ржЖрж░ ржХрж╛ржЬ рж╢рзЗрж╖ рж╣рж▓рзЗ ржЖржмрж╛рж░ ржЫрзЛржЯ ржХрж░рзЗ ржлрзЗрж▓рзЗред
* stack growth ржПржмржВ shrink ржжрзБржЯрзЛржЗ safe ржУ automatic

тЮбя╕П ржлрж▓: рждрзБржорж┐ рж▓рж╛ржЦ go routine рждрзИрж░рж┐ ржХрж░рж▓рзЗржУ out of memory рж╣ржмрзЗ ржирж╛ред

---

## ЁЯзй **рзмя╕П. ржХрзЗржи Goroutine ржПржд рж╕рж╕рзНрждрж╛ (Cheap)**

тЬЕ ржЫрзЛржЯ Stack тЖТ Memory ржХржо рж▓рж╛ржЧрзЗ
тЬЕ User-space Scheduler тЖТ Kernel-ржП ржмрж╛рж░ржмрж╛рж░ ржпрзЗрждрзЗ рж╣рзЯ ржирж╛
тЬЕ Auto Load Balancing тЖТ Scheduler ржирж┐ржЬрзЗржЗ CPU ржЧрзБрж▓рзЛрждрзЗ ржХрж╛ржЬ ржнрж╛ржЧ ржХрж░рзЗ ржжрзЗрзЯ
тЬЕ Communication Mechanism (Channels) тЖТ Safe data sharing

ЁЯСЙ ржлрж▓рж╛ржлрж▓:
рждрзБржорж┐ ржЪрж╛ржЗрж▓рзЗ рзз рж▓рж╛ржЦ+ Goroutine рждрзИрж░рж┐ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ ржПржмржВ рждрж╛ржУ ржкрзНрж░рзЛржЧрзНрж░рж╛ржо ржарж┐ржХржарж╛ржХ ржЪрж▓ржмрзЗред

---

## ЁЯзй **рзня╕П. Goroutine Lifecycle**

```
New тЖТ Runnable тЖТ Running тЖТ Waiting тЖТ Runnable тЖТ Dead
```

* **New:** just created, not yet scheduled
* **Runnable:** ready queue рждрзЗ ржЕржкрзЗржХрзНрж╖рж╛ ржХрж░рзЗ
* **Running:** currently executing
* **Waiting:** I/O ржмрж╛ channel ржПрж░ ржЬржирзНржп ржмрзНрж▓ржХржб
* **Dead:** execution рж╢рзЗрж╖

Go runtime ржП ржкрзНрж░рждрж┐ `P` ржПрж░ queue ржерж╛ржХрзЗ ржпрзЗржЦрж╛ржирзЗ Runnable goroutine ржерж╛ржХрзЗред

---

## ЁЯзй **рзоя╕П. main() рж╢рзЗрж╖ рж╣рж▓рзЗ ржХрзА рж╣рзЯ**

* Go рждрзЗ `main()` ржирж┐ржЬрзЗржЗ ржПржХржЯрж┐ Goroutine (main Goroutine)ред
* main() рж╢рзЗрж╖ рж╣рж▓рзЗ program terminate рж╣рзЯрзЗ ржпрж╛рзЯ, ржЕржирзНржп goroutine kill рж╣рзЯрзЗ ржпрж╛рзЯред

---

## ЁЯТ╗ **Hands-On Exercises**

### 1я╕ПтГг Simple Goroutine

```go
package main
import (
	"fmt"
	"time"
)
func main() {
	go func() {
		fmt.Println("Hello Goroutine!")
	}()
	time.Sleep(50 * time.Millisecond)
	fmt.Println("Main done")
}
```

> ЁЯзй Try removing `time.Sleep()` тАФ youтАЩll likely not see тАЬHello, Goroutine!тАЭ
> because the main Goroutine ends first.

### 2я╕ПтГг Multiple Goroutines

```go
package main
import (
	"fmt"
	"time"
)
func printMsg(msg string) {
	fmt.Println(msg)
}
func main() {
	go printMsg("Alpha")
	go printMsg("Beta")
	go printMsg("Gamma")
	time.Sleep(100 * time.Millisecond)
	fmt.Println("Main exiting")
}
```

> Run it several times тАФ youтАЩll see the output order change.
> ThatтАЩs because Goroutines run concurrently; the scheduler decides their order.

### 3я╕ПтГг Demonstrate Main Exit

```go
func main() {
	go fmt.Println("A")
	go fmt.Println("B")
	go fmt.Println("C")
}
```

Output:
тЖТ often nothing prints, because main exits immediately.

---

## ЁЯза **ржирж┐ржЬрзЗ ржнрж╛ржмрзЛ**

1. Concurrency vs Parallelism ржПрж░ ржорзВрж▓ ржкрж╛рж░рзНржержХрзНржп ржХрж┐?
2. ржХрзЗржи Goroutine lightweight?
3. M-P-G ржоржбрзЗрж▓ ржПрж░ ржнрзВржорж┐ржХрж╛ ржХрж┐?
4. Stack growth ржХрзЗржи important?
5. main() рж╢рзЗрж╖ рж╣рж▓рзЗ program ржХрзЗржи terminate рж╣рзЯ?
6. Preemption ржХрзАржнрж╛ржмрзЗ scheduler ржХрзЗ рж╕рж╣рж╛рзЯрждрж╛ ржХрж░рзЗ?

---

## ЁЯз╛ **рж╕рж╛рж░рж╕ржВржХрзНрж╖рзЗржк**

| ржзрж╛рж░ржгрж╛                | ржорзВрж▓ ржкрзЯрзЗржирзНржЯ                                     |
| -------------------- | ---------------------------------------------- |
| **Goroutine**        | user-space lightweight thread                  |
| **Scheduler**        | ржЕржирзЗржХ goroutine ржХрзЗ ржХржо рж╕ржВржЦрзНржпржХ thread ржП ржорзНржпрж╛ржк ржХрж░рзЗ |
| **Stack Management** | ржЫрзЛржЯ stack тЖТ auto grow/shrink                   |
| **Preemption**       | scheduler ржирж┐ржЬрзЗ context switch ржХрж░рж╛рждрзЗ ржкрж╛рж░рзЗ       |
| **Efficiency**       | рж▓ржХрзНрж╖рж╛ржзрж┐ржХ goroutine рж╕рж╣ржЬрзЗ manage ржХрж░рзЗ             |
| **Exit Rule**        | main() рж╢рзЗрж╖ тЖТ рж╕ржм goroutine рж╢рзЗрж╖                  |

---

## ЁЯУЪ **рж░рж┐рж╕рзЛрж░рзНрж╕**

* ЁЯУШ [Go by Example тАФ Goroutines](https://gobyexample.com/goroutines)
* ЁЯУШ [Go Tour тАФ Concurrency Section](https://go.dev/tour/concurrency/1)
* ЁЯУЦ [Go Blog тАФ Concurrency is Not Parallelism (Rob Pike)](https://go.dev/blog/waza-talk)
* ЁЯУЦ [Inside the Go Scheduler (Morsmachine)](https://morsmachine.dk/go-scheduler)
* ЁЯОе [Rob Pike тАФ тАЬConcurrency Is Not ParallelismтАЭ](https://www.youtube.com/watch?v=cN_DpYBzKso)
* ЁЯОе [GopherCon тАФ тАЬInside the Go SchedulerтАЭ by Dmitry Vyukov](https://www.youtube.com/watch?v=YHRO5WQGh0k)

---

## ЁЯзй **Mini Challenge**

ржПржХржЯрж╛ ржкрзНрж░рзЛржЧрзНрж░рж╛ржо рж▓рж┐ржЦрзЛ ржпрзЗржЯрж╛:

* рззрзжрзж ржЯрж╛ goroutine ржЪрж╛рж▓рж╛ржмрзЗ
* ржкрзНрж░рждрзНржпрзЗржХрзЗ ржирж┐ржЬрзЗрж░ ржирж╛ржо ржкрзНрж░рж┐ржирзНржЯ ржХрж░ржмрзЗ (тАЬWorker 1тАЭ ржерзЗржХрзЗ тАЬWorker 100тАЭ)
* main ржлрж╛ржВрж╢ржирзЗ ржПржХржЯрж╛ sleep ржжрж╛ржУ ржпрж╛рждрзЗ рж╕ржмржЧрзБрж▓рзЛ ржЪрж╛рж▓рж╛рждрзЗ ржкрж╛рж░рзЗ
* output order observe ржХрж░рзЛ (ржкрзНрж░рждрж┐ржмрж╛рж░ ржнрж┐ржирзНржи рж╣ржмрзЗ)

---

## ЁЯза **Deep Think Exercise**

<details>
<summary>1я╕ПтГг рждрзБржорж┐ Go runtime рж╣рж┐рж╕рзЗржмрзЗ ржнрж╛ржмрзЛ тАФ рждрзБржорж┐ ржХрзАржнрж╛ржмрзЗ decide ржХрж░ржмрзЗ ржХрзЛржи goroutine ржЖржЧрзЗ run рж╣ржмрзЗ?</summary>

Go runtime ржПрж░ scheduler **run queue** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ goroutine ржЧрзБрж▓рзЛржХрзЗ ржорзНржпрж╛ржирзЗржЬ ржХрж░рзЗред
ржкрзНрж░рждрж┐ржЯрж┐ Processor (P)-ржПрж░ ржирж┐ржЬрж╕рзНржм queue ржерж╛ржХрзЗред Scheduler **FIFO (first in, first out)** ржирж┐рзЯржорзЗ goroutine ржЪрж╛рж▓рж╛рзЯред

рждржмрзЗ ржпржжрж┐ ржХрзЛржирзЛ goroutine I/O ржХрж░рзЗ ржмрж╛ ржмрзНрж▓ржХ рж╣рзЯ, рждржЦржи scheduler рж╕рзЗржЯрж┐ржХрзЗ **waiting state** ржП ржкрж╛ржарж╛рзЯ
ржПржмржВ ржЕржирзНржп ready goroutine ржХрзЗ CPU ржжрзЗрзЯ тАФ ржПрждрзЗ ржХрзЛржирзЛ goroutine ржжрзАрж░рзНржШ рж╕ржорзЯ idle ржерж╛ржХрзЗ ржирж╛ред

</details>

---

<details>
<summary>2я╕ПтГг ржпржжрж┐ ржПржХржЯрж╛ goroutine CPU-bound ржерж╛ржХрзЗ (ржпрзЗржоржи infinite loop), рждрж╛рж╣рж▓рзЗ ржЕржирзНржп goroutine ржХрж┐ ржЪрж▓ржмрзЗ? (тЖТ preemption)</summary>

рж╣рзНржпрж╛ржБ, ржПржЦржи Go 1.14+ ржерзЗржХрзЗ **asynchronous preemption** ржЖржЫрзЗред
Scheduler ржжрзАрж░рзНржШ рж╕ржорзЯ ржзрж░рзЗ ржЪрж▓рж╛ (CPU-bound) goroutine ржХрзЗ ржЬрзЛрж░ ржХрж░рзЗ ржерж╛ржорж┐рзЯрзЗ ржжрзЗрзЯ
ржПржмржВ ржЕржирзНржп goroutine ржХрзЗ run ржХрж░рж╛рж░ рж╕рзБржпрзЛржЧ ржжрзЗрзЯред

ржПрж░ ржлрж▓рзЗ ржХрзЛржирзЛ goroutine ржкрзБрж░рзЛ CPU ржжржЦрж▓ ржХрж░рзЗ рж░рж╛ржЦрждрзЗ ржкрж╛рж░рзЗ ржирж╛ред

</details>

---

<details>
<summary>3я╕ПтГг ржПржХ goroutine blocking I/O ржХрж░рж▓рзЗ ржХрж┐ ржмрж╛ржХрж┐ржЧрзБрж▓рзЛ ржерзЗржорзЗ ржпрж╛рзЯ?</summary>

ржирж╛ тЭМ

Go runtime ржкрзНрж░рждрж┐ржЯрж┐ **blocking call** (ржпрзЗржоржи network, file I/O) ржЖрж▓рж╛ржжрж╛ OS thread-ржП ржкрж╛ржарж┐рзЯрзЗ ржжрзЗрзЯред
рждржЦржи рж╕рзЗржЗ thread ржмрзНрж▓ржХ ржерж╛ржХрж▓рзЗржУ runtime ржЕржирзНржп goroutine ржЧрзБрж▓рзЛржХрзЗ ржЕржирзНржп thread (M) ржжрж┐рзЯрзЗ ржЪрж╛рж▓рж┐рзЯрзЗ ржпрж╛рзЯред

ржлрж▓рзЗ I/O-bound goroutine ржерж╛ржорж▓рзЗржУ ржкрзБрж░рзЛ ржкрзНрж░рзЛржЧрзНрж░рж╛ржо ржмрзНрж▓ржХ рж╣рзЯ ржирж╛ред

</details>

---

<details>
<summary>4я╕ПтГг ржХрзАржнрж╛ржмрзЗ `GOMAXPROCS` runtime performance ржкрзНрж░ржнрж╛ржмрж┐ржд ржХрж░рзЗ?</summary>

`GOMAXPROCS` ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рзЗ ржПржХрж╕рж╛ржерзЗ ржХрзЯржЯрж╛ **OS thread (Processor P)** CPU-рждрзЗ active ржерж╛ржХржмрзЗред

* ржпржжрж┐ ржПржЯрж╛ **CPU core рж╕ржВржЦрзНржпрж╛рж░ рж╕ржорж╛ржи** рж░рж╛ржЦрж╛ рж╣рзЯ тЖТ performance optimal рж╣рзЯ ЁЯза
* ржЦрзБржм ржХржо ржжрж┐рж▓рзЗ тЖТ CPU ржкрзБрж░рзЛржкрзБрж░рж┐ ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯ ржирж╛ (idle ржерж╛ржХрзЗ)
* ржЦрзБржм ржмрзЗрж╢рж┐ ржжрж┐рж▓рзЗ тЖТ context switching ржмрзЗрзЬрзЗ ржпрж╛рзЯ, performance ржХржорзЗ

ЁЯТб рж╕рж╛ржзрж╛рж░ржгржд `runtime.GOMAXPROCS(runtime.NumCPU())` рж╕ржмржЪрзЗрзЯрзЗ ржнрж╛рж▓рзЛ рж╕рзЗржЯрж┐ржВред

</details>

---

## ЁЯФо **Day 2 Preview: Channels**

ржкрж░рзЗрж░ ржжрж┐ржи ржЖржорж░рж╛ рж╢рж┐ржЦржм Go ржПрж░ рж╕ржмржЪрзЗрзЯрзЗ ржорзНржпрж╛ржЬрж┐ржХрж╛рж▓ ржЕржВрж╢ тАФ
**Channel** тАФ Goroutine ржжрзЗрж░ ржоржзрзНржпрзЗ ржирж┐рж░рж╛ржкржж communication ржПрж░ ржЙржкрж╛рзЯред
ржЖржорж░рж╛ ржжрзЗржЦржм:

* Unbuffered vs Buffered Channel
* Data Synchronization
* Channel blocking behavior
* Deadlock avoidance pattern

---
